DEV=/dev/spidev32766.0

#switch
#Port Traffic Control Register
#Forwarding state
br_test $DEV w 0x00 0x00 0xA0
br_test $DEV w 0x00 0x01 0xA0
br_test $DEV w 0x00 0x02 0xA0
br_test $DEV w 0x00 0x03 0xA0
br_test $DEV w 0x00 0x04 0xA0
br_test $DEV w 0x00 0x05 0xA0
br_test $DEV w 0x00 0x07 0xA0
#Switch Mode Register: forwardind enable, unmanaged mode
br_test $DEV w 0x00 0x0B 0x06
#Protected Port Selection Register
br_test $DEV w16 0x00 0x25 0x0000
#Reserved Multicast Control Register: forward all
br_test $DEV w 0x00 0x2F 0x00
# Multicast Lookup Failed Forward Map Register
br_test $DEV w16 0x00 0x34 0x0100
# MLF IPMC Forward Map Register
br_test $DEV w16 0x00 0x36 0x0100
#Port State Override Register
# SW override: 100Mb, full duplex, link-up
#Port0..3 - Br0..Br3
br_test $DEV w 0x00 0x58 0x47
br_test $DEV w 0x00 0x59 0x47
br_test $DEV w 0x00 0x5A 0x47
br_test $DEV w 0x00 0x5B 0x47
#Port 4 - Br4 - vidobox fron panel
#br_test $DEV w 0x00 0x5C 0x47
#Port 5 - MII2 - ext phy
br_test $DEV w 0x00 0x5D 0x4B
#RGMII Timing Delay Register for Port 4
# RX_CLK delay, TX_CLK delay
br_test $DEV w 0x00 0x64 0x03
#Global Management Configuration Register
# Enable IMP port only. All traffic to the CPU from LAN and WAN ports will be forwarded to IMP port
# Enables all ports to receive BPDUs and forwards to the IMP port. This bit must be set to globally allow BPDUs to be received. 
 br_test $DEV w 0x02 0x00 0x82                         
# Broadcom Header Control Register
# Enable BRCM header for Port 7
#br_test $DEV w 0x02 0x03 0x04
# Switch Control Register
# forwarding for dumb mode
# MII3 - 2.5V
# MII2 - 2.5V
# MII1 - 2.5V
br_test $DEV w16 0x00 0x22 0x47

#IMP port (MII1)
# IMP Port Control Register
# Receive unicast enable 
# Receive multicast enable 
# Receive broadcast enable 
br_test $DEV w 0x00 0x08 0x1c
#Port status override: link pass, full duplex, 1000Mb, override
br_test $DEV w 0x00 0x0E 0x8b
#Port status override: link pass, full duplex, 100Mb, override
#br_test $DEV w 0x00 0x0E 0x87
#Port status override: link pass, full duplex, 100Mb, override
#br_test $DEV w 0x00 0x0E 0x87
#RGMII Timing Delay Register for IMP Port
# RX_CLK no delay, TX_CLK no delay       
#br_test $DEV w 0x00 0x60 0x00
# RX_CLK delay, TX_CLK delay       
br_test $DEV w 0x00 0x60 0x03 

#QoS
br_test $DEV w 0x00 0x30 0x80

exit

#phy0
echo Init phy0
br_test $DEV w16 0x10 0x30 0x0C00
br_test $DEV w16 0x10 0x2e 0x0001
br_test $DEV w16 0x10 0x2a 0x0027
br_test $DEV w16 0x10 0x2e 0x0F92
br_test $DEV w16 0x10 0x2a 0x9225
br_test $DEV w16 0x10 0x38 0xAC00
br_test $DEV w16 0x10 0x2e 0x0FFD
br_test $DEV w16 0x10 0x2a 0x1C3F
br_test $DEV w16 0x10 0x2e 0x0FFE
br_test $DEV w16 0x10 0x2a 0x1C3F
#br_test $DEV w16 0x10 0x00 0x2008
br_test $DEV w16 0x10 0x00 0x0208

#phy1
echo Init phy1
br_test $DEV w16 0x11 0x30 0x0C00
br_test $DEV w16 0x11 0x2e 0x0001
br_test $DEV w16 0x11 0x2a 0x0027
br_test $DEV w16 0x11 0x2e 0x0F92
br_test $DEV w16 0x11 0x2a 0x9225
br_test $DEV w16 0x11 0x38 0xAC00
br_test $DEV w16 0x11 0x2e 0x0FFD
br_test $DEV w16 0x11 0x2a 0x1C3F
br_test $DEV w16 0x11 0x2e 0x0FFE
br_test $DEV w16 0x11 0x2a 0x1C3F
#br_test $DEV w16 0x11 0x00 0x2008
br_test $DEV w16 0x11 0x00 0x0208

#phy2
echo Init phy2
br_test $DEV w16 0x12 0x30 0x0C00
br_test $DEV w16 0x12 0x2e 0x0001
br_test $DEV w16 0x12 0x2a 0x0027
br_test $DEV w16 0x12 0x2e 0x0F92
br_test $DEV w16 0x12 0x2a 0x9225
br_test $DEV w16 0x12 0x38 0xAC00
br_test $DEV w16 0x12 0x2e 0x0FFD
br_test $DEV w16 0x12 0x2a 0x1C3F
br_test $DEV w16 0x12 0x2e 0x0FFE
br_test $DEV w16 0x12 0x2a 0x1C3F
#br_test $DEV w16 0x12 0x00 0x2008
br_test $DEV w16 0x12 0x00 0x0208

#phy3
echo Init phy3
br_test $DEV w16 0x13 0x30 0x0C00
br_test $DEV w16 0x13 0x2e 0x0001
br_test $DEV w16 0x13 0x2a 0x0027
br_test $DEV w16 0x13 0x2e 0x0F92
br_test $DEV w16 0x13 0x2a 0x9225
br_test $DEV w16 0x13 0x38 0xAC00
br_test $DEV w16 0x13 0x2e 0x0FFD
br_test $DEV w16 0x13 0x2a 0x1C3F
br_test $DEV w16 0x13 0x2e 0x0FFE
br_test $DEV w16 0x13 0x2a 0x1C3F
#br_test $DEV w16 0x13 0x00 0x2008
br_test $DEV w16 0x13 0x00 0x0208

#phy4 (videobox front panel)
echo Init phy4
br_test $DEV w16 0x14 0x30 0x0C00
br_test $DEV w16 0x14 0x2e 0x0001
br_test $DEV w16 0x14 0x2a 0x0027
br_test $DEV w16 0x14 0x2e 0x0F92
br_test $DEV w16 0x14 0x2a 0x9225
br_test $DEV w16 0x14 0x38 0xAC00
br_test $DEV w16 0x14 0x2e 0x0FFD
br_test $DEV w16 0x14 0x2a 0x1C3F
br_test $DEV w16 0x14 0x2e 0x0FFE
br_test $DEV w16 0x14 0x2a 0x1C3F
#br_test $DEV w16 0x14 0x00 0x2008
br_test $DEV w16 0x14 0x00 0x0208

