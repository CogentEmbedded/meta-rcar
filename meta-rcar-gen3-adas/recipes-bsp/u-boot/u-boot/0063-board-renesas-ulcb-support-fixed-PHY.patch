From 342cd278d7bb18ae11d9d4e4d0d1575fab1d2f62 Mon Sep 17 00:00:00 2001
From: Valentine Barshak <valentine.barshak@cogentembedded.com>
Date: Fri, 30 Nov 2018 01:38:16 +0300
Subject: [PATCH 11/11] arm: renesas: Enable Fixed PHY on H3ULCB-HAD

This enables Fixed PHY on H3ULCB-HAD board.

Signed-off-by: Valentine Barshak <valentine.barshak@cogentembedded.com>
---
 arch/arm/dts/ulcb.dtsi         | 17 ++++++-----------
 configs/r8a7795_ulcb_defconfig |  4 ++--
 2 files changed, 8 insertions(+), 13 deletions(-)

diff --git a/arch/arm/dts/ulcb.dtsi b/arch/arm/dts/ulcb.dtsi
index c561d1d..cff3643 100644
--- a/arch/arm/dts/ulcb.dtsi
+++ b/arch/arm/dts/ulcb.dtsi
@@ -152,18 +152,13 @@
 };
 
 &avb {
-	pinctrl-0 = <&avb_pins>;
-	pinctrl-names = "default";
-	phy-handle = <&phy0>;
-	phy-mode = "rgmii-txid";
-	status = "okay";
+	/delete-property/phy-handle;
+	/delete-property/phy-gpios;
+	/delete-node/ethernet-phy@0;
 
-	phy0: ethernet-phy@0 {
-		rxc-skew-ps = <1500>;
-		reg = <0>;
-		interrupt-parent = <&gpio2>;
-		interrupts = <11 IRQ_TYPE_LEVEL_LOW>;
-		reset-gpios = <&gpio2 10 GPIO_ACTIVE_LOW>;
+	fixed-link {
+		speed = <1000>;
+		full-duplex;
 	};
 };
 
diff --git a/configs/r8a7795_ulcb_defconfig b/configs/r8a7795_ulcb_defconfig
index 9336a23..41ac184 100644
--- a/configs/r8a7795_ulcb_defconfig
+++ b/configs/r8a7795_ulcb_defconfig
@@ -50,9 +50,9 @@ CONFIG_MTD_NOR_FLASH=y
 CONFIG_MTD_DEVICE=y
 CONFIG_CFI_FLASH=y
 CONFIG_RENESAS_RPC_HF=y
-CONFIG_PHY_MICREL=y
-CONFIG_PHY_MICREL_KSZ90X1=y
+CONFIG_PHY_FIXED=y
 CONFIG_DM_ETH=y
+CONFIG_PHY_GIGE=y
 CONFIG_RENESAS_RAVB=y
 CONFIG_PINCTRL=y
 CONFIG_PINCONF=y
-- 
2.7.4

