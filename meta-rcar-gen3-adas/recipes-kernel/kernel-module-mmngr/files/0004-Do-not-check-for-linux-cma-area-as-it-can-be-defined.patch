From 92dfadb86b4c98566b87af46ff3c382085a40ea5 Mon Sep 17 00:00:00 2001
From: Andrey Dolnikov <andrey.dolnikov@cogentembedded.com>
Date: Mon, 18 Jun 2018 12:25:09 +0300
Subject: [PATCH] Do not check for 'linux,cma' area as it can be defined using
 command line 'cma' option.

---
 mmngr_drv/mmngr/mmngr-module/files/mmngr/drv/mmngr_drv.c | 16 ++++++----------
 1 file changed, 6 insertions(+), 10 deletions(-)

diff --git a/mmngr_drv/mmngr/mmngr-module/files/mmngr/drv/mmngr_drv.c b/mmngr_drv/mmngr/mmngr-module/files/mmngr/drv/mmngr_drv.c
index c38329d..22f9341 100644
--- a/mmngr_drv/mmngr/mmngr-module/files/mmngr/drv/mmngr_drv.c
+++ b/mmngr_drv/mmngr/mmngr-module/files/mmngr/drv/mmngr_drv.c
@@ -85,8 +85,6 @@ static struct BM		bm_ssp;
 static struct LOSSY_DATA	lossy_entries[MAX_LOSSY_ENTRIES];
 static struct MM_DRVDATA	*mm_drvdata;
 static struct cma		*mm_cma_area;
-static u64			mm_common_reserve_addr;
-static u64			mm_common_reserve_size;
 static u64			mm_kernel_reserve_addr;
 static u64			mm_kernel_reserve_size;
 static u64			mm_lossybuf_addr;
@@ -1053,14 +1051,12 @@ static int parse_reserved_mem_dt(void)
 {
 	int ret = 0;
 
-	ret = _parse_reserved_mem_dt(
-			"/reserved-memory/linux,cma",
-			&mm_common_reserve_addr, &mm_common_reserve_size);
-	if (ret) {
-		pr_warn("Failed to parse common CMA reserved area" \
-			 "(linux,cma) from DT\n");
-		return ret;
-	}
+	/*
+	 * Do not check 'linux,cma' here as it can be defined
+	 * using command line 'cma' option.
+	 * If it was not reserved at all (or is too small), memory allocation will return an error
+	 * which is fine.
+	 */
 
 	ret = _parse_reserved_mem_dt(
 			"/reserved-memory/linux,multimedia",
-- 
2.7.4

