From 5d318e8b313d577992ef98a97fdfd4524c2cf193 Mon Sep 17 00:00:00 2001
From: Valentine Barshak <valentine.barshak@cogentembedded.com>
Date: Thu, 15 Nov 2018 23:52:59 +0300
Subject: [PATCH 03/17] clk: renesas: r8a77980: cpg-mssr: Add RPC clock

Add RPCSRC clock support. This is based
on the original patch by Dmitry Shifrin.

Signed-off-by: Dmitry Shifrin <dmitry.shifrin@cogentembedded.com>
Signed-off-by: Valentine Barshak <valentine.barshak@cogentembedded.com>
---
 drivers/clk/renesas/r8a77980-cpg-mssr.c       | 3 +++
 include/dt-bindings/clock/r8a77980-cpg-mssr.h | 1 +
 2 files changed, 4 insertions(+)

diff --git a/drivers/clk/renesas/r8a77980-cpg-mssr.c b/drivers/clk/renesas/r8a77980-cpg-mssr.c
index 096ceda..1855986 100644
--- a/drivers/clk/renesas/r8a77980-cpg-mssr.c
+++ b/drivers/clk/renesas/r8a77980-cpg-mssr.c
@@ -92,6 +92,8 @@ static const struct cpg_core_clk r8a77980_core_clks[] __initconst = {
 
 	DEF_GEN3_SD("sd0",	R8A77980_CLK_SD0,   CLK_SDSRC,	  0x0074),
 
+	DEF_GEN3_RPCSRC("rpcsrc", R8A77980_CLK_RPCSRC, CLK_PLL1,  0x0238),
+
 	DEF_FIXED("cl",		R8A77980_CLK_CL,    CLK_PLL1_DIV2, 48, 1),
 	DEF_FIXED("cp",		R8A77980_CLK_CP,    CLK_EXTAL,	    2, 1),
 	DEF_FIXED("cpex",	R8A77980_CLK_CPEX,  CLK_EXTAL,	    2, 1),
@@ -185,6 +187,7 @@ static const struct mssr_mod_clk r8a77980_mod_clks[] __initconst = {
 	DEF_MOD("gpio1",		 911,	R8A77980_CLK_CP),
 	DEF_MOD("gpio0",		 912,	R8A77980_CLK_CP),
 	DEF_MOD("can-fd",		 914,	R8A77980_CLK_S3D2),
+	DEF_MOD("rpc",			 917,	R8A77980_CLK_RPCSRC),
 	DEF_MOD("i2c4",			 927,	R8A77980_CLK_S0D6),
 	DEF_MOD("i2c3",			 928,	R8A77980_CLK_S0D6),
 	DEF_MOD("i2c2",			 929,	R8A77980_CLK_S3D2),
diff --git a/include/dt-bindings/clock/r8a77980-cpg-mssr.h b/include/dt-bindings/clock/r8a77980-cpg-mssr.h
index a4c0d76..3dd4323 100644
--- a/include/dt-bindings/clock/r8a77980-cpg-mssr.h
+++ b/include/dt-bindings/clock/r8a77980-cpg-mssr.h
@@ -47,5 +47,6 @@
 #define R8A77980_CLK_CPEX		35
 #define R8A77980_CLK_R			36
 #define R8A77980_CLK_OSC		37
+#define R8A77980_CLK_RPCSRC		38
 
 #endif /* __DT_BINDINGS_CLOCK_R8A77980_CPG_MSSR_H__ */
-- 
2.7.4

