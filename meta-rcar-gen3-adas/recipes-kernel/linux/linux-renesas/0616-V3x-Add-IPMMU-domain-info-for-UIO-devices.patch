From 785c6e9ed0cafe1517666bcb5f7e9af753ddb87b Mon Sep 17 00:00:00 2001
From: Andrey Dolnikov <andrey.dolnikov@cogentembedded.com>
Date: Mon, 14 Sep 2020 11:21:07 +0300
Subject: [PATCH] V3x: Add IPMMU domain info for UIO devices

...needed for OSAL/xOS
---
 arch/arm64/boot/dts/renesas/r8a77970.dtsi      | 21 +++++++++++
 arch/arm64/boot/dts/renesas/r8a77980.dtsi      | 52 +++++++++++++++++++++++++-
 include/dt-bindings/ipmmu/rcar-ipmmu-domains.h |  1 +
 include/dt-bindings/ipmmu/rcar-ipmmu.h         |  6 +++
 include/uapi/linux/rcar-ipmmu-domains.h        | 33 ++++++++++++++++
 5 files changed, 112 insertions(+), 1 deletion(-)
 create mode 120000 include/dt-bindings/ipmmu/rcar-ipmmu-domains.h
 create mode 100644 include/dt-bindings/ipmmu/rcar-ipmmu.h
 create mode 100644 include/uapi/linux/rcar-ipmmu-domains.h

diff --git a/arch/arm64/boot/dts/renesas/r8a77970.dtsi b/arch/arm64/boot/dts/renesas/r8a77970.dtsi
index 53d92dc..fdeaf6f 100644
--- a/arch/arm64/boot/dts/renesas/r8a77970.dtsi
+++ b/arch/arm64/boot/dts/renesas/r8a77970.dtsi
@@ -10,6 +10,7 @@
 #include <dt-bindings/interrupt-controller/arm-gic.h>
 #include <dt-bindings/interrupt-controller/irq.h>
 #include <dt-bindings/power/r8a77970-sysc.h>
+#include <dt-bindings/ipmmu/rcar-ipmmu.h>
 
 / {
 	compatible = "renesas,r8a77970";
@@ -855,6 +856,7 @@
 			resets = <&cpg 811>;
 			renesas,id = <0>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin1: vin_01@e6ef1000 {
@@ -866,6 +868,7 @@
 			resets = <&cpg 810>;
 			renesas,id = <1>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin2: vin_02@e6ef2000 {
@@ -877,6 +880,7 @@
 			resets = <&cpg 809>;
 			renesas,id = <2>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin3: vin_03@e6ef3000 {
@@ -888,6 +892,7 @@
 			resets = <&cpg 808>;
 			renesas,id = <3>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		imp_distributer: imp_ctrl_00 {
@@ -905,6 +910,7 @@
 			reg = <0 0xff900000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 827>;
 			power-domains = <&sysc R8A77970_PD_A2IR0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_01 {
@@ -912,6 +918,7 @@
 			reg = <0 0xff920000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 827>;
 			power-domains = <&sysc R8A77970_PD_A2IR0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_02 {
@@ -919,6 +926,7 @@
 			reg = <0 0xff940000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 826>;
 			power-domains = <&sysc R8A77970_PD_A2IR1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_03 {
@@ -926,6 +934,7 @@
 			reg = <0 0xff960000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 826>;
 			power-domains = <&sysc R8A77970_PD_A2IR1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_00 {
@@ -933,6 +942,7 @@
 			reg = <0 0xff980000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 829>;
 			power-domains = <&sysc R8A77970_PD_A2SC0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_01 {
@@ -940,6 +950,7 @@
 			reg = <0 0xff990000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 828>;
 			power-domains = <&sysc R8A77970_PD_A2SC1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_dma_00 {
@@ -947,6 +958,7 @@
 			reg = <0 0xffa10000 0 0x1000>;
 			clocks = <&cpg CPG_MOD 825>;
 			power-domains = <&sysc R8A77970_PD_A2DP>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_psc_00 {
@@ -954,6 +966,7 @@
 			reg = <0 0xffa20000 0 0x4000>;
 			clocks = <&cpg CPG_MOD 825>;
 			power-domains = <&sysc R8A77970_PD_A2DP>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_cnn_00 {
@@ -961,6 +974,7 @@
 			reg = <0 0xff9e0000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 824>;
 			power-domains = <&sysc R8A77970_PD_A2CN>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_mem_00 {
@@ -983,6 +997,7 @@
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
 			resets = <&cpg 823>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		imrlx4_ch1: imr_01@fe870000 {
@@ -994,6 +1009,7 @@
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
 			resets = <&cpg 822>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		imrlx4_ch2: imr_02@fe880000 {
@@ -1005,6 +1021,7 @@
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
 			resets = <&cpg 821>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		imrlx4_ch3: imr_03@fe890000 {
@@ -1016,6 +1033,7 @@
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
 			resets = <&cpg 820>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		isp0: isp@fec00000 {
@@ -1034,6 +1052,7 @@
 			interrupts = <GIC_SPI 25 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 817>;
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		cisp0: cisp_00 {
@@ -1042,6 +1061,7 @@
 			interrupts = <GIC_SPI 26 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 817>;
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		sadc0: adc@ffce0000 {
@@ -1447,6 +1467,7 @@
 			clocks = <&cpg CPG_MOD 127>;
 			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
 			interrupts = <GIC_SPI 300 IRQ_TYPE_LEVEL_HIGH>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		irq_ivcp1e_00_01 {
diff --git a/arch/arm64/boot/dts/renesas/r8a77980.dtsi b/arch/arm64/boot/dts/renesas/r8a77980.dtsi
index 66bfbf7..b23cccc 100644
--- a/arch/arm64/boot/dts/renesas/r8a77980.dtsi
+++ b/arch/arm64/boot/dts/renesas/r8a77980.dtsi
@@ -10,6 +10,7 @@
 #include <dt-bindings/interrupt-controller/irq.h>
 #include <dt-bindings/interrupt-controller/arm-gic.h>
 #include <dt-bindings/power/r8a77980-sysc.h>
+#include <dt-bindings/ipmmu/rcar-ipmmu.h>
 
 / {
 	compatible = "renesas,r8a77980";
@@ -901,6 +902,7 @@
 			resets = <&cpg 811>;
 			renesas,id = <0>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin1: vin_01@e6ef1000 {
@@ -912,6 +914,7 @@
 			status = "disabled";
 			renesas,id = <1>;
 			resets = <&cpg 810>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin2: vin_02@e6ef2000 {
@@ -923,6 +926,7 @@
 			resets = <&cpg 809>;
 			renesas,id = <2>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin3: vin_03@e6ef3000 {
@@ -934,6 +938,7 @@
 			resets = <&cpg 808>;
 			renesas,id = <3>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin4: vin_04@e6ef4000 {
@@ -945,6 +950,7 @@
 			resets = <&cpg 807>;
 			renesas,id = <4>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin5: vin_05@e6ef5000 {
@@ -956,6 +962,7 @@
 			resets = <&cpg 806>;
 			renesas,id = <5>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin6: vin_06@e6ef6000 {
@@ -967,6 +974,7 @@
 			resets = <&cpg 805>;
 			renesas,id = <6>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin7: vin_07@e6ef7000 {
@@ -978,6 +986,7 @@
 			resets = <&cpg 804>;
 			renesas,id = <7>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin8: vin_08@e6ef8000 {
@@ -989,6 +998,7 @@
 			resets = <&cpg 628>;
 			renesas,id = <8>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin9: vin_09@e6ef9000 {
@@ -1000,6 +1010,7 @@
 			resets = <&cpg 627>;
 			renesas,id = <9>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin10: vin_10@e6efa000 {
@@ -1011,6 +1022,7 @@
 			resets = <&cpg 625>;
 			renesas,id = <10>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin11: vin_11@e6efb000 {
@@ -1022,6 +1034,7 @@
 			resets = <&cpg 618>;
 			renesas,id = <11>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin12: vin_12@e6efc000 {
@@ -1033,6 +1046,7 @@
 			resets = <&cpg 612>;
 			renesas,id = <12>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin13: vin_13@e6efd000 {
@@ -1044,6 +1058,7 @@
 			resets = <&cpg 608>;
 			renesas,id = <13>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin14: vin_14@e6efe000 {
@@ -1055,6 +1070,7 @@
 			resets = <&cpg 605>;
 			renesas,id = <14>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		vin15: vin_15@e6eff000 {
@@ -1066,6 +1082,7 @@
 			resets = <&cpg 604>;
 			renesas,id = <15>;
 			status = "disabled";
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		imp_distributer: imp_ctrl_00 {
@@ -1115,6 +1132,7 @@
 			reg = <0 0xff900000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 827>;
 			power-domains = <&sysc R8A77980_PD_A2IR0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_01 {
@@ -1122,6 +1140,7 @@
 			reg = <0 0xff920000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 826>;
 			power-domains = <&sysc R8A77980_PD_A2IR1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_02 {
@@ -1129,6 +1148,7 @@
 			reg = <0 0xff940000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 825>;
 			power-domains = <&sysc R8A77980_PD_A2IR2>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_03 {
@@ -1136,6 +1156,7 @@
 			reg = <0 0xff960000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 824>;
 			power-domains = <&sysc R8A77980_PD_A2IR3>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_imp_04 {
@@ -1143,6 +1164,7 @@
 			reg = <0 0xffa80000 0 0x20000>;
 			clocks = <&cpg CPG_MOD 521>;
 			power-domains = <&sysc R8A77980_PD_A2IR4>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_slim_00 {
@@ -1150,6 +1172,7 @@
 			reg = <0 0xff9c0000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 500>;
 			power-domains = <&sysc R8A77980_PD_A2IR5>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_00 {
@@ -1157,6 +1180,7 @@
 			reg = <0 0xff980000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 829>;
 			power-domains = <&sysc R8A77980_PD_A2SC0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_01 {
@@ -1164,6 +1188,7 @@
 			reg = <0 0xff990000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 828>;
 			power-domains = <&sysc R8A77980_PD_A2SC1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_02 {
@@ -1171,6 +1196,7 @@
 			reg = <0 0xff9a0000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 531>;
 			power-domains = <&sysc R8A77980_PD_A2SC2>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_03 {
@@ -1178,6 +1204,7 @@
 			reg = <0 0xff9b0000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 529>;
 			power-domains = <&sysc R8A77980_PD_A2SC3>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_ocv_04 {
@@ -1185,6 +1212,7 @@
 			reg = <0 0xffa40000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 528>;
 			power-domains = <&sysc R8A77980_PD_A2SC4>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_dma_00 {
@@ -1192,6 +1220,7 @@
 			reg = <0 0xffa10000 0 0x1000>;
 			clocks = <&cpg CPG_MOD 527>;
 			power-domains = <&sysc R8A77980_PD_A2DP0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_dma_01 {
@@ -1199,6 +1228,7 @@
 			reg = <0 0xffa14000 0 0x1000>;
 			clocks = <&cpg CPG_MOD 526>;
 			power-domains = <&sysc R8A77980_PD_A2DP1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_psc_00 {
@@ -1206,6 +1236,7 @@
 			reg = <0 0xffa20000 0 0x4000>;
 			clocks = <&cpg CPG_MOD 525>;
 			power-domains = <&sysc R8A77980_PD_A2DP0>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_psc_01 {
@@ -1213,6 +1244,7 @@
 			reg = <0 0xffa24000 0 0x4000>;
 			clocks = <&cpg CPG_MOD 524>;
 			power-domains = <&sysc R8A77980_PD_A2DP1>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_cnn_00 {
@@ -1220,6 +1252,7 @@
 			reg = <0 0xff9e0000 0 0x10000>;
 			clocks = <&cpg CPG_MOD 831>;
 			power-domains = <&sysc R8A77980_PD_A2CN>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
 		};
 
 		imp_mem_00 {
@@ -1242,6 +1275,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			resets = <&cpg 823>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		imrlx4_ch1: imr_01@fe870000 {
@@ -1253,6 +1287,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			resets = <&cpg 822>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		imrlx4_ch2: imr_02@fe880000 {
@@ -1264,6 +1299,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			resets = <&cpg 821>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		imrlx4_ch3: imr_03@fe890000 {
@@ -1275,6 +1311,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			resets = <&cpg 820>;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		imrlx4_ch4: imr_04@fe8a0000 {
@@ -1286,6 +1323,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			rse;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		imrlx4_ch5: imr_05@fe8b0000 {
@@ -1297,6 +1335,7 @@
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			rse;
 			alloc-dev = <&imr_v4l2_alloc>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
 		};
 
 		stv_00 {
@@ -1305,6 +1344,7 @@
 			interrupts = <GIC_SPI 238 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 101>;
 			power-domains = <&sysc R8A77980_PD_A3VIP0>;
+			ipmmu-id = <RCAR_IPMMU_VIP0>;
 		};
 
 		irq_stv_00_01 {
@@ -1321,6 +1361,7 @@
 			interrupts = <GIC_SPI 242 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 102>;
 			power-domains = <&sysc R8A77980_PD_A3VIP1>;
+			ipmmu-id = <RCAR_IPMMU_VIP0>;
 		};
 
 		irq_dof_00_01 {
@@ -1337,6 +1378,7 @@
 			interrupts = <GIC_SPI 71 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 1004>;
 			power-domains = <&sysc R8A77980_PD_A3VIP2>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
 		};
 
 		irq_acf_00_01 {
@@ -1353,6 +1395,7 @@
 			interrupts = <GIC_SPI 98 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 1003>;
 			power-domains = <&sysc R8A77980_PD_A3VIP2>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
 		};
 
 		irq_acf_01_01 {
@@ -1369,6 +1412,7 @@
 			interrupts = <GIC_SPI 100 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 1002>;
 			power-domains = <&sysc R8A77980_PD_A3VIP2>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
 		};
 
 		irq_acf_02_01 {
@@ -1385,6 +1429,7 @@
 			interrupts = <GIC_SPI 102 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 1001>;
 			power-domains = <&sysc R8A77980_PD_A3VIP2>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
 		};
 
 		irq_acf_03_01 {
@@ -1401,6 +1446,7 @@
 			interrupts = <GIC_SPI 104 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 1000>;
 			power-domains = <&sysc R8A77980_PD_A3VIP2>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
 		};
 
 		irq_acf_04_01 {
@@ -1446,7 +1492,6 @@
 			reg = <0 0xe7410000 0 0x10000>;
 		};
 
-
 		fcpr_c53_00 {
 			compatible = "generic-uio";
 			reg = <0 0xf12a0000 0 0x10000>;
@@ -1485,6 +1530,7 @@
 			clocks = <&cpg CPG_MOD 817>;
 			resets = <&cpg 817>;
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		cisp0: cisp_00 {
@@ -1494,6 +1540,7 @@
 			clocks = <&cpg CPG_MOD 817>;
 			resets = <&cpg 817>;
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		tisp1: tisp_01 {
@@ -1503,6 +1550,7 @@
 			clocks = <&cpg CPG_MOD 814>;
 			resets = <&cpg 814>;
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		cisp1: cisp_01 {
@@ -1512,6 +1560,7 @@
 			clocks = <&cpg CPG_MOD 814>;
 			resets = <&cpg 814>;
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		dmac1: dma-controller@e7300000 {
@@ -2025,6 +2074,7 @@
 			clocks = <&cpg CPG_MOD 127>;
 			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
 			interrupts = <GIC_SPI 300 IRQ_TYPE_LEVEL_HIGH>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
 		};
 
 		irq_ivcp1e_00_01 {
diff --git a/include/dt-bindings/ipmmu/rcar-ipmmu-domains.h b/include/dt-bindings/ipmmu/rcar-ipmmu-domains.h
new file mode 120000
index 0000000..9bce1eb
--- /dev/null
+++ b/include/dt-bindings/ipmmu/rcar-ipmmu-domains.h
@@ -0,0 +1 @@
+../../uapi/linux/rcar-ipmmu-domains.h
\ No newline at end of file
diff --git a/include/dt-bindings/ipmmu/rcar-ipmmu.h b/include/dt-bindings/ipmmu/rcar-ipmmu.h
new file mode 100644
index 0000000..ff99996
--- /dev/null
+++ b/include/dt-bindings/ipmmu/rcar-ipmmu.h
@@ -0,0 +1,6 @@
+#ifndef _DT_BINDINGS_RCAR_IPMMU_H
+#define _DT_BINDINGS_RCAR_IPMMU_H
+
+#include "rcar-ipmmu-domains.h"
+
+#endif /* _DT_BINDINGS_RCAR_IPMMU_H */
diff --git a/include/uapi/linux/rcar-ipmmu-domains.h b/include/uapi/linux/rcar-ipmmu-domains.h
new file mode 100644
index 0000000..8e297d5
--- /dev/null
+++ b/include/uapi/linux/rcar-ipmmu-domains.h
@@ -0,0 +1,33 @@
+/*
+ * Copyright (C) 2020 Cogent Embedded Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+#ifndef __LINUX_RCAR_IPMMU_DOMAINS_H__
+#define __LINUX_RCAR_IPMMU_DOMAINS_H__
+
+#define RCAR_IPMMU_INVALID	0
+#define RCAR_IPMMU_MM		1
+#define RCAR_IPMMU_VI0		2
+#define RCAR_IPMMU_VI1		3
+#define RCAR_IPMMU_VP0		4
+#define RCAR_IPMMU_VP1		5
+#define RCAR_IPMMU_VC0		6
+#define RCAR_IPMMU_VC1		7
+#define RCAR_IPMMU_PV0		8
+#define RCAR_IPMMU_PV1		9
+#define RCAR_IPMMU_PV2		10
+#define RCAR_IPMMU_PV3		11
+#define RCAR_IPMMU_IR		12
+#define RCAR_IPMMU_HC		13
+#define RCAR_IPMMU_RT		14
+#define RCAR_IPMMU_MP		15
+#define RCAR_IPMMU_DS0		16
+#define RCAR_IPMMU_DS1		17
+#define RCAR_IPMMU_VIP0		18
+#define RCAR_IPMMU_VIP1		19
+
+#endif /* __LINUX_RCAR_IPMMU_DOMAINS_H__ */
+
-- 
2.7.4

