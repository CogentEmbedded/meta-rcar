From c3c9ad98aefbac4af72489d8fab2aabb5d51835c Mon Sep 17 00:00:00 2001
From: Andrey Dolnikov <andrey.dolnikov@cogentembedded.com>
Date: Fri, 16 Oct 2020 22:58:55 +0300
Subject: [PATCH 03/11] arm64: dts: r8a77970, r8a77980: Convert IPMMU to UIO

Signed-off-by: Andrey Dolnikov <andrey.dolnikov@cogentembedded.com>
---
 arch/arm64/boot/dts/renesas/r8a77970.dtsi | 44 +++++++++++++++++++++
 arch/arm64/boot/dts/renesas/r8a77980.dtsi | 65 +++++++++++++++++++++++++++++++
 2 files changed, 109 insertions(+)

diff --git a/arch/arm64/boot/dts/renesas/r8a77970.dtsi b/arch/arm64/boot/dts/renesas/r8a77970.dtsi
index 40c7ddd..64e4ba74 100644
--- a/arch/arm64/boot/dts/renesas/r8a77970.dtsi
+++ b/arch/arm64/boot/dts/renesas/r8a77970.dtsi
@@ -1241,6 +1241,50 @@
 			#iommu-cells = <1>;
 		};
 
+		ipmmu_ds1 {
+			compatible = "generic-uio";
+			reg = <0 0xe7740000 0 0x1000>;
+			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_DS1>;
+		};
+
+		ipmmu_ir {
+			compatible = "generic-uio";
+			reg = <0 0xff8b0000 0 0x1000>;
+			power-domains = <&sysc R8A77970_PD_A3IR>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
+		};
+
+		ipmmu_mm {
+			compatible = "generic-uio";
+			reg = <0 0xe67b0000 0 0x1000>;
+			interrupts = <GIC_SPI 196 IRQ_TYPE_LEVEL_HIGH>;
+			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_MM>;
+		};
+
+		irq_ipmmu_mm_01 {
+			compatible = "generic-uio";
+			reg = <0 0xe67b0000 0 0x1000>;
+			interrupts = <GIC_SPI 197 IRQ_TYPE_LEVEL_HIGH>;
+			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_MM>;
+		};
+
+		ipmmu_rt {
+			compatible = "generic-uio";
+			reg = <0 0xffc80000 0 0x1000>;
+			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_RT>;
+		};
+
+		ipmmu_vi0 {
+			compatible = "generic-uio";
+			reg = <0 0xfebd0000 0 0x1000>;
+			power-domains = <&sysc R8A77970_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
+		};
+
 		mmc0: mmc@ee140000 {
 			compatible = "renesas,sdhi-r8a77970",
 				     "renesas,rcar-gen3-sdhi";
diff --git a/arch/arm64/boot/dts/renesas/r8a77980.dtsi b/arch/arm64/boot/dts/renesas/r8a77980.dtsi
index a56d352..a6f2c1c 100644
--- a/arch/arm64/boot/dts/renesas/r8a77980.dtsi
+++ b/arch/arm64/boot/dts/renesas/r8a77980.dtsi
@@ -1858,6 +1858,71 @@
 			#iommu-cells = <1>;
 		};
 
+		ipmmu_ds1 {
+			compatible = "generic-uio";
+			reg = <0 0xe7740000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_DS1>;
+		};
+
+		ipmmu_ir {
+			compatible = "generic-uio";
+			reg = <0 0xff8b0000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_A3IR>;
+			ipmmu-id = <RCAR_IPMMU_IR>;
+		};
+
+		ipmmu_mm {
+			compatible = "generic-uio";
+			reg = <0 0xe67b0000 0 0x1000>;
+			interrupts = <GIC_SPI 196 IRQ_TYPE_LEVEL_HIGH>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_MM>;
+		};
+
+		irq_ipmmu_mm_01 {
+			compatible = "generic-uio";
+			reg = <0 0xe67b0000 0 0x1000>;
+			interrupts = <GIC_SPI 197 IRQ_TYPE_LEVEL_HIGH>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_MM>;
+		};
+
+		ipmmu_rt {
+			compatible = "generic-uio";
+			reg = <0 0xffc80000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_RT>;
+		};
+
+		ipmmu_vc0 {
+			compatible = "generic-uio";
+			reg = <0 0xfe6b0000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VC0>;
+		};
+
+		ipmmu_vi0 {
+			compatible = "generic-uio";
+			reg = <0 0xfebd0000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VI0>;
+		};
+
+		ipmmu_vip0 {
+			compatible = "generic-uio";
+			reg = <0 0xe7b00000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VIP0>;
+		};
+
+		ipmmu_vip1 {
+			compatible = "generic-uio";
+			reg = <0 0xe7960000 0 0x1000>;
+			power-domains = <&sysc R8A77980_PD_ALWAYS_ON>;
+			ipmmu-id = <RCAR_IPMMU_VIP1>;
+		};
+
 		mmc0: mmc@ee140000 {
 			compatible = "renesas,sdhi-r8a77980",
 				     "renesas,rcar-gen3-sdhi";
-- 
2.7.4

